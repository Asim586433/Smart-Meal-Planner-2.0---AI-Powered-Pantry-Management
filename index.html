<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Meal Planner 2.0 | AI-Powered Pantry Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #7C3AED;
            --primary-dark: #6D28D9;
            --secondary: #10B981;
            --accent: #F59E0B;
            --danger: #EF4444;
            --light: #F8FAFC;
            --dark: #1E293B;
            --gray: #64748B;
            --border: #E2E8F0;
            --gradient: linear-gradient(135deg, #7C3AED 0%, #10B981 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%);
            color: var(--dark);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Modern Header */
        header {
            background: white;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
        }
        
        .logo-area {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            background: var(--gradient);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        .logo-text {
            font-size: 24px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-badge {
            background: var(--secondary);
            color: white;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .nav-tabs {
            display: flex;
            gap: 4px;
            background: #F1F5F9;
            padding: 4px;
            border-radius: 12px;
        }
        
        .nav-tab {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--gray);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-tab:hover {
            color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
        }
        
        .nav-tab.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.2);
        }
        
        .user-area {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .notifications {
            position: relative;
            cursor: pointer;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ai-assistant-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s ease;
        }
        
        .ai-assistant-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Main Layout */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 24px;
            padding: 24px 0;
            min-height: calc(100vh - 80px);
        }
        
        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        
        .sidebar-section {
            margin-bottom: 32px;
        }
        
        .sidebar-title {
            font-size: 12px;
            text-transform: uppercase;
            color: var(--gray);
            font-weight: 600;
            margin-bottom: 16px;
            letter-spacing: 1px;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 10px;
            color: var(--dark);
            text-decoration: none;
            margin-bottom: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .sidebar-item:hover {
            background: #F8FAFC;
            color: var(--primary);
        }
        
        .sidebar-item.active {
            background: rgba(124, 58, 237, 0.1);
            color: var(--primary);
            font-weight: 600;
        }
        
        .sidebar-item i {
            width: 20px;
            text-align: center;
        }
        
        .badge {
            background: var(--primary);
            color: white;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: auto;
        }
        
        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .page {
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Dashboard */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .dashboard-title {
            font-size: 32px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .dashboard-subtitle {
            color: var(--gray);
            margin-top: 8px;
        }
        
        .date-filter {
            display: flex;
            align-items: center;
            gap: 12px;
            background: white;
            padding: 8px 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .stat-trend {
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .trend-up {
            color: var(--secondary);
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 4px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }
        
        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .chart-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 700;
        }
        
        /* AI Features */
        .ai-features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .ai-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .ai-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }
        
        .ai-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .ai-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: rgba(124, 58, 237, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 20px;
        }
        
        /* Pantry Page */
        .pantry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .search-add-container {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        
        .search-box {
            position: relative;
            width: 300px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 20px 12px 48px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }
        
        .btn-secondary {
            background: #F1F5F9;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #E2E8F0;
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        /* Categories */
        .categories-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            overflow-x: auto;
            padding-bottom: 8px;
        }
        
        .category-chip {
            padding: 8px 16px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }
        
        .category-chip:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .category-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Pantry Grid */
        .pantry-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .pantry-item-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .pantry-item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            border-color: var(--primary);
        }
        
        .expiry-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .expiry-soon {
            background: #FEF3C7;
            color: #92400E;
        }
        
        .expiry-good {
            background: #D1FAE5;
            color: #065F46;
        }
        
        .item-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .item-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }
        
        .item-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .item-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            color: var(--gray);
            font-size: 14px;
        }
        
        .quantity-slider {
            width: 100%;
            margin: 16px 0;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }
        
        /* AI Chat Assistant */
        .ai-chat-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 400px;
            height: 600px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
        }
        
        .ai-chat-container.active {
            display: flex;
        }
        
        .chat-header {
            background: var(--gradient);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 16px;
            line-height: 1.5;
        }
        
        .message-user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .message-ai {
            align-self: flex-start;
            background: #F1F5F9;
            color: var(--dark);
            border-bottom-left-radius: 4px;
        }
        
        .chat-input {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
        }
        
        .chat-input input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            margin-bottom: 24px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 8px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-features-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-container {
                width: 350px;
                height: 500px;
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .pantry-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-container {
                width: 100%;
                height: 70vh;
                bottom: 0;
                right: 0;
                border-radius: 20px 20px 0 0;
            }
            
            .nav-tabs {
                display: none;
            }
            
            .search-box {
                width: 100%;
            }
        }
        
        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Loading States */
        .loading {
            background: linear-gradient(90deg, #F1F5F9 0%, #E2E8F0 50%, #F1F5F9 100%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 1002;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .toast {
            background: white;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .toast-success {
            border-left: 4px solid var(--secondary);
        }
        
        .toast-error {
            border-left: 4px solid var(--danger);
        }
        
        .toast-info {
            border-left: 4px solid var(--primary);
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- AI Chat Assistant -->
    <div class="ai-chat-container" id="aiChat">
        <div class="chat-header">
            <div>
                <h3 style="margin: 0; font-weight: 700;">AI Meal Assistant</h3>
                <p style="margin: 4px 0 0; opacity: 0.9; font-size: 14px;">Powered by GPT-4</p>
            </div>
            <button id="closeChat" style="background: none; border: none; color: white; cursor: pointer; font-size: 20px;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message message-ai">
                Hello! I'm your AI Meal Assistant. I can help you plan meals, suggest recipes based on your pantry, generate shopping lists, and answer nutrition questions. How can I assist you today?
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Ask me anything about meal planning...">
            <button id="sendMessage" class="btn btn-primary">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="logo-area">
                <div class="logo-icon">
                    <i class="fas fa-apple-alt"></i>
                </div>
                <div>
                    <div class="logo-text">MealPlanner 2.0<span class="logo-badge">AI</span></div>
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" data-page="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </button>
                <button class="nav-tab" data-page="pantry">
                    <i class="fas fa-warehouse"></i> Pantry
                </button>
                <button class="nav-tab" data-page="meal-planning">
                    <i class="fas fa-calendar-alt"></i> Meal Planning
                </button>
                <button class="nav-tab" data-page="recipes">
                    <i class="fas fa-utensils"></i> Recipes
                </button>
                <button class="nav-tab" data-page="shopping">
                    <i class="fas fa-shopping-cart"></i> Shopping
                </button>
                <button class="nav-tab" data-page="nutrition">
                    <i class="fas fa-chart-pie"></i> Nutrition
                </button>
            </div>
            
            <div class="user-area">
                <div class="notifications">
                    <i class="fas fa-bell" style="font-size: 20px; color: var(--gray);"></i>
                    <span class="notification-badge">3</span>
                </div>
                <button class="ai-assistant-btn" id="openChat">
                    <i class="fas fa-robot"></i> AI Assistant
                </button>
                <div class="avatar" id="userAvatar">U</div>
            </div>
        </div>
    </header>

    <!-- Main App Container -->
    <div class="container app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">Quick Actions</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-item active" data-page="dashboard">
                        <i class="fas fa-home"></i> Dashboard
                        <span class="badge">AI</span>
                    </li>
                    <li class="sidebar-item" data-page="pantry">
                        <i class="fas fa-plus-circle"></i> Add to Pantry
                    </li>
                    <li class="sidebar-item" data-page="meal-planning">
                        <i class="fas fa-robot"></i> AI Meal Suggestions
                    </li>
                    <li class="sidebar-item" data-page="shopping">
                        <i class="fas fa-cart-plus"></i> Generate Shopping List
                    </li>
                    <li class="sidebar-item" data-page="nutrition">
                        <i class="fas fa-chart-line"></i> Nutrition Insights
                    </li>
                </ul>
            </div>
            
            <div class="sidebar-section">
                <h3 class="sidebar-title">Smart Features</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-item" data-feature="expiry-tracker">
                        <i class="fas fa-clock"></i> Expiry Tracker
                        <span class="badge">3</span>
                    </li>
                    <li class="sidebar-item" data-feature="waste-reduction">
                        <i class="fas fa-recycle"></i> Waste Reduction
                    </li>
                    <li class="sidebar-item" data-feature="budget-tracker">
                        <i class="fas fa-wallet"></i> Budget Tracker
                    </li>
                    <li class="sidebar-item" data-feature="meal-prep">
                        <i class="fas fa-blender"></i> Meal Prep Assistant
                    </li>
                </ul>
            </div>
            
            <div class="sidebar-section">
                <h3 class="sidebar-title">Integrations</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-item">
                        <i class="fab fa-instacart"></i> Instacart
                    </li>
                    <li class="sidebar-item">
                        <i class="fab fa-amazon"></i> Amazon Fresh
                    </li>
                    <li class="sidebar-item">
                        <i class="fas fa-heartbeat"></i> Apple Health
                    </li>
                    <li class="sidebar-item">
                        <i class="fab fa-google"></i> Google Calendar
                    </li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="dashboard-header">
                    <div>
                        <h1 class="dashboard-title">Welcome Back, User!</h1>
                        <p class="dashboard-subtitle">Here's your meal planning overview for today</p>
                    </div>
                    <div class="date-filter">
                        <i class="fas fa-calendar"></i>
                        <span id="currentDate">Today, November 30, 2023</span>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--primary);">
                                <i class="fas fa-warehouse"></i>
                            </div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 12%
                            </div>
                        </div>
                        <div class="stat-value" id="pantryCount">24</div>
                        <div class="stat-label">Items in Pantry</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--secondary);">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 8%
                            </div>
                        </div>
                        <div class="stat-value" id="mealCount">14</div>
                        <div class="stat-label">Meals This Week</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--accent);">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="stat-trend trend-down">
                                <i class="fas fa-arrow-down"></i> 15%
                            </div>
                        </div>
                        <div class="stat-value" id="shoppingCount">8</div>
                        <div class="stat-label">Shopping Items</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--danger);">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 3
                            </div>
                        </div>
                        <div class="stat-value" id="expiryCount">5</div>
                        <div class="stat-label">Expiring Soon</div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Weekly Meal Planning</h3>
                            <select class="form-control" style="width: auto; padding: 8px 16px;">
                                <option>This Week</option>
                                <option>Last Week</option>
                                <option>This Month</option>
                            </select>
                        </div>
                        <canvas id="mealChart" height="250"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3 class="chart-title">Nutrition Balance</h3>
                            <i class="fas fa-info-circle" style="color: var(--gray);"></i>
                        </div>
                        <canvas id="nutritionChart" height="250"></canvas>
                    </div>
                </div>

                <!-- AI Features Grid -->
                <div class="ai-features-grid">
                    <div class="ai-card" id="aiMealSuggestions">
                        <div class="ai-card-header">
                            <div class="ai-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div>
                                <h3 style="margin: 0 0 4px;">AI Meal Suggestions</h3>
                                <p style="margin: 0; color: var(--gray); font-size: 14px;">Based on your pantry</p>
                            </div>
                        </div>
                        <p style="margin-bottom: 16px; color: var(--gray);">Get personalized meal ideas using advanced AI that analyzes your pantry items, preferences, and nutrition goals.</p>
                        <button class="btn btn-primary" onclick="generateAISuggestions()">
                            <i class="fas fa-magic"></i> Generate Suggestions
                        </button>
                    </div>
                    
                    <div class="ai-card" id="smartShopping">
                        <div class="ai-card-header">
                            <div class="ai-icon">
                                <i class="fas fa-cart-plus"></i>
                            </div>
                            <div>
                                <h3 style="margin: 0 0 4px;">Smart Shopping List</h3>
                                <p style="margin: 0; color: var(--gray); font-size: 14px;">AI-powered optimization</p>
                            </div>
                        </div>
                        <p style="margin-bottom: 16px; color: var(--gray);">Generate optimized shopping lists based on meal plans, budget constraints, and store availability.</p>
                        <button class="btn btn-secondary" onclick="generateShoppingList()">
                            <i class="fas fa-bolt"></i> Generate List
                        </button>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Quick Actions</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <button class="btn btn-secondary" onclick="showModal('addItemModal')">
                            <i class="fas fa-plus"></i> Add to Pantry
                        </button>
                        <button class="btn btn-secondary" onclick="switchPage('meal-planning')">
                            <i class="fas fa-calendar-plus"></i> Plan Meals
                        </button>
                        <button class="btn btn-secondary" onclick="scanReceipt()">
                            <i class="fas fa-receipt"></i> Scan Receipt
                        </button>
                        <button class="btn btn-secondary" onclick="voiceInput()">
                            <i class="fas fa-microphone"></i> Voice Input
                        </button>
                    </div>
                </div>
            </div>

            <!-- Pantry Page -->
            <div id="pantry" class="page">
                <div class="pantry-header">
                    <div>
                        <h1 class="dashboard-title">Smart Pantry</h1>
                        <p class="dashboard-subtitle">Manage your pantry items with AI-powered insights</p>
                    </div>
                    <div class="search-add-container">
                        <div class="search-box">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" id="pantrySearch" placeholder="Search pantry items...">
                        </div>
                        <div class="action-buttons">
                            <button class="btn btn-primary" onclick="showModal('addItemModal')">
                                <i class="fas fa-plus"></i> Add Item
                            </button>
                            <button class="btn btn-secondary" onclick="showModal('bulkAddModal')">
                                <i class="fas fa-upload"></i> Bulk Add
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Categories -->
                <div class="categories-bar">
                    <div class="category-chip active">All Items</div>
                    <div class="category-chip" data-category="expiring">Expiring Soon</div>
                    <div class="category-chip" data-category="protein">Protein</div>
                    <div class="category-chip" data-category="vegetables">Vegetables</div>
                    <div class="category-chip" data-category="fruits">Fruits</div>
                    <div class="category-chip" data-category="dairy">Dairy</div>
                    <div class="category-chip" data-category="grains">Grains</div>
                    <div class="category-chip" data-category="spices">Spices</div>
                    <div class="category-chip" data-category="beverages">Beverages</div>
                </div>

                <!-- Pantry Grid -->
                <div class="pantry-grid" id="pantryGrid">
                    <!-- Pantry items will be loaded here -->
                </div>

                <!-- AI Recommendations -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">
                            <i class="fas fa-lightbulb" style="color: var(--accent);"></i>
                            AI Recommendations
                        </h3>
                        <button class="btn btn-sm btn-primary" onclick="refreshRecommendations()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                    <div id="aiRecommendations" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                        <!-- AI recommendations will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Meal Planning Page -->
            <div id="meal-planning" class="page">
                <div class="pantry-header">
                    <div>
                        <h1 class="dashboard-title">AI Meal Planning</h1>
                        <p class="dashboard-subtitle">Plan your meals with smart AI suggestions</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateWeeklyPlan()">
                            <i class="fas fa-robot"></i> Generate Weekly Plan
                        </button>
                        <button class="btn btn-secondary" onclick="showModal('mealPreferencesModal')">
                            <i class="fas fa-sliders-h"></i> Preferences
                        </button>
                    </div>
                </div>

                <!-- Weekly Calendar -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Weekly Meal Calendar</h3>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-sm btn-secondary">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span style="font-weight: 600;">Nov 27 - Dec 3</span>
                            <button class="btn btn-sm btn-secondary">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div id="weeklyCalendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 12px; margin-top: 20px;">
                        <!-- Days will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Recipe Suggestions -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Recommended Recipes</h3>
                        <select class="form-control" style="width: auto; padding: 8px 16px;" id="recipeFilter">
                            <option>Based on Pantry</option>
                            <option>Quick Meals</option>
                            <option>Healthy Options</option>
                            <option>Family Favorites</option>
                        </select>
                    </div>
                    <div id="recipeSuggestions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                        <!-- Recipes will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Shopping List Page -->
            <div id="shopping" class="page">
                <div class="pantry-header">
                    <div>
                        <h1 class="dashboard-title">Smart Shopping List</h1>
                        <p class="dashboard-subtitle">AI-optimized shopping with price comparison</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="optimizeShoppingList()">
                            <i class="fas fa-bolt"></i> Optimize List
                        </button>
                        <button class="btn btn-secondary" onclick="exportShoppingList()">
                            <i class="fas fa-share"></i> Export
                        </button>
                    </div>
                </div>

                <!-- Shopping List -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Shopping List</h3>
                        <div style="display: flex; align-items: center; gap: 16px;">
                            <span style="color: var(--gray);">Total Estimated: <strong id="shoppingTotal">$45.67</strong></span>
                            <button class="btn btn-sm btn-accent" onclick="comparePrices()">
                                <i class="fas fa-balance-scale"></i> Compare Prices
                            </button>
                        </div>
                    </div>
                    <div id="shoppingList" style="margin-top: 20px;">
                        <!-- Shopping items will be loaded here -->
                    </div>
                </div>

                <!-- Store Comparison -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Store Price Comparison</h3>
                        <button class="btn btn-sm btn-secondary" onclick="refreshPrices()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                    <div id="priceComparison" style="margin-top: 20px;">
                        <!-- Price comparison will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Add Item Modal -->
            <div class="modal" id="addItemModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Add Item to Pantry</h2>
                        <p style="color: var(--gray);">Add items manually or use AI scanning</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Item Name</label>
                        <input type="text" class="form-control" id="itemName" placeholder="e.g., Organic Chicken Breast">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">Quantity</label>
                            <input type="text" class="form-control" id="itemQuantity" placeholder="e.g., 2 lbs">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" id="itemCategory">
                                <option>Protein</option>
                                <option>Vegetables</option>
                                <option>Fruits</option>
                                <option>Dairy</option>
                                <option>Grains</option>
                                <option>Spices</option>
                                <option>Beverages</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label">Expiry Date</label>
                            <input type="date" class="form-control" id="itemExpiry">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Storage Location</label>
                            <select class="form-control" id="itemLocation">
                                <option>Refrigerator</option>
                                <option>Freezer</option>
                                <option>Pantry</option>
                                <option>Counter</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-control" id="itemNotes" rows="3" placeholder="Any additional notes..."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="addPantryItem()">
                            <i class="fas fa-plus"></i> Add Item
                        </button>
                        <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('addItemModal')">
                            Cancel
                        </button>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-accent" onclick="scanBarcode()">
                            <i class="fas fa-barcode"></i> Scan Barcode
                        </button>
                        <button class="btn btn-secondary" onclick="useCamera()" style="margin-left: 12px;">
                            <i class="fas fa-camera"></i> Take Photo
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Application State
        const appState = {
            currentUser: { name: "User", email: "user@mealplanner.com" },
            isAuthenticated: true,
            aiProvider: "GPT-4",
            llmWrapperUrl: "https://api.yourdomain.com/llm/generate",
            
            pantryItems: [
                { id: 1, name: "Organic Chicken Breast", quantity: "2 lbs", category: "Protein", expiry: "2023-12-15", location: "Refrigerator", notes: "Free-range", status: "good" },
                { id: 2, name: "Brown Rice", quantity: "5 lbs", category: "Grains", expiry: "2024-06-30", location: "Pantry", notes: "Organic", status: "good" },
                { id: 3, name: "Fresh Broccoli", quantity: "3 heads", category: "Vegetables", expiry: "2023-12-10", location: "Refrigerator", notes: "", status: "expiring" },
                { id: 4, name: "Free-range Eggs", quantity: "12 count", category: "Dairy", expiry: "2023-12-20", location: "Refrigerator", notes: "Large size", status: "good" },
                { id: 5, name: "Extra Virgin Olive Oil", quantity: "500ml", category: "Condiments", expiry: "2024-12-01", location: "Pantry", notes: "Cold pressed", status: "good" },
                { id: 6, name: "Organic Garlic", quantity: "10 cloves", category: "Vegetables", expiry: "2023-12-25", location: "Counter", notes: "", status: "good" },
                { id: 7, name: "Sweet Onions", quantity: "5 pieces", category: "Vegetables", expiry: "2023-12-18", location: "Pantry", notes: "", status: "expiring" },
                { id: 8, name: "Whole Wheat Pasta", quantity: "2 boxes", category: "Grains", expiry: "2024-08-15", location: "Pantry", notes: "", status: "good" },
                { id: 9, name: "Tomato Sauce", quantity: "24 oz", category: "Condiments", expiry: "2024-05-30", location: "Pantry", notes: "Low sodium", status: "good" },
                { id: 10, name: "Almond Milk", quantity: "1 gallon", category: "Beverages", expiry: "2023-12-12", location: "Refrigerator", notes: "Unsweetened", status: "expiring" },
                { id: 11, name: "Bananas", quantity: "6 pieces", category: "Fruits", expiry: "2023-12-09", location: "Counter", notes: "", status: "expiring" },
                { id: 12, name: "Baby Spinach", quantity: "16 oz", category: "Vegetables", expiry: "2023-12-08", location: "Refrigerator", notes: "Organic", status: "expiring" }
            ],
            
            mealPlan: [
                { day: "Monday", breakfast: "Smoothie Bowl", lunch: "Chicken Salad", dinner: "Stir Fry", snacks: ["Apple", "Yogurt"] },
                { day: "Tuesday", breakfast: "Oatmeal", lunch: "Leftovers", dinner: "Pasta Primavera", snacks: ["Banana"] },
                { day: "Wednesday", breakfast: "Eggs & Toast", lunch: "Quinoa Bowl", dinner: "Salmon & Veggies", snacks: ["Nuts"] },
                { day: "Thursday", breakfast: "Smoothie", lunch: "Chicken Wrap", dinner: "Vegetable Curry", snacks: ["Fruit"] },
                { day: "Friday", breakfast: "Yogurt Parfait", lunch: "Leftovers", dinner: "Pizza Night", snacks: ["Crackers"] },
                { day: "Saturday", breakfast: "Pancakes", lunch: "Grilled Cheese", dinner: "Steak Dinner", snacks: ["Chips"] },
                { day: "Sunday", breakfast: "Brunch", lunch: "Meal Prep", dinner: "Roast Chicken", snacks: ["Dark Chocolate"] }
            ],
            
            shoppingList: [
                { id: 1, name: "Carrots", quantity: "1 lb", category: "Vegetables", estimatedPrice: 1.99, store: "Walmart", checked: false },
                { id: 2, name: "Bell Peppers", quantity: "3 pieces", category: "Vegetables", estimatedPrice: 2.49, store: "Whole Foods", checked: false },
                { id: 3, name: "Ground Beef", quantity: "1 lb", category: "Protein", estimatedPrice: 8.99, store: "Costco", checked: false },
                { id: 4, name: "Cheddar Cheese", quantity: "8 oz", category: "Dairy", estimatedPrice: 3.99, store: "Trader Joe's", checked: true },
                { id: 5, name: "Whole Wheat Bread", quantity: "1 loaf", category: "Grains", estimatedPrice: 4.99, store: "Local Bakery", checked: false }
            ],
            
            aiRecommendations: [],
            chatHistory: [],
            notifications: [
                { id: 1, type: "warning", message: "3 items expiring in 3 days", timestamp: "2 hours ago" },
                { id: 2, type: "info", message: "AI generated new meal suggestions", timestamp: "1 day ago" },
                { id: 3, type: "success", message: "Shopping list optimized. Saved $12.50", timestamp: "2 days ago" }
            ]
        };

        // DOM Elements
        const navTabs = document.querySelectorAll('.nav-tab');
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        const pages = document.querySelectorAll('.page');
        const aiChat = document.getElementById('aiChat');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendMessageBtn = document.getElementById('sendMessage');
        const openChatBtn = document.getElementById('openChat');
        const closeChatBtn = document.getElementById('closeChat');
        const pantryGrid = document.getElementById('pantryGrid');
        const weeklyCalendar = document.getElementById('weeklyCalendar');
        const recipeSuggestions = document.getElementById('recipeSuggestions');
        const shoppingListContainer = document.getElementById('shoppingList');
        const aiRecommendationsContainer = document.getElementById('aiRecommendations');

        // Initialize the application
        function initApp() {
            // Set current date
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            // Initialize charts
            initCharts();
            
            // Load initial data
            renderPantryItems();
            renderWeeklyCalendar();
            renderRecipeSuggestions();
            renderShoppingList();
            renderAIRecommendations();
            updateDashboardStats();
            
            // Set up event listeners
            setupEventListeners();
            
            // Show welcome toast
            showToast("Welcome to MealPlanner 2.0! Your AI-powered meal planning assistant is ready.", "success");
        }

        // Set up event listeners
        function setupEventListeners() {
            // Navigation tabs
            navTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const pageId = tab.getAttribute('data-page');
                    switchPage(pageId);
                    
                    // Update active tab
                    navTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                });
            });
            
            // Sidebar items
            sidebarItems.forEach(item => {
                item.addEventListener('click', () => {
                    const pageId = item.getAttribute('data-page');
                    if (pageId) {
                        switchPage(pageId);
                        
                        // Update active tab
                        navTabs.forEach(tab => {
                            tab.classList.remove('active');
                            if (tab.getAttribute('data-page') === pageId) {
                                tab.classList.add('active');
                            }
                        });
                    }
                });
            });
            
            // AI Chat
            openChatBtn.addEventListener('click', () => {
                aiChat.classList.add('active');
                chatInput.focus();
            });
            
            closeChatBtn.addEventListener('click', () => {
                aiChat.classList.remove('active');
            });
            
            sendMessageBtn.addEventListener('click', sendChatMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendChatMessage();
            });
            
            // Category chips
            document.querySelectorAll('.category-chip').forEach(chip => {
                chip.addEventListener('click', () => {
                    document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    filterPantryItems(chip.getAttribute('data-category'));
                });
            });
        }

        // Initialize charts
        function initCharts() {
            // Meal planning chart
            const mealCtx = document.getElementById('mealChart').getContext('2d');
            new Chart(mealCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Meals Planned',
                        data: [3, 4, 3, 4, 3, 5, 4],
                        borderColor: '#7C3AED',
                        backgroundColor: 'rgba(124, 58, 237, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 6
                        }
                    }
                }
            });

            // Nutrition chart
            const nutritionCtx = document.getElementById('nutritionChart').getContext('2d');
            new Chart(nutritionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Protein', 'Carbs', 'Fats', 'Fiber'],
                    datasets: [{
                        data: [30, 40, 20, 10],
                        backgroundColor: [
                            '#7C3AED',
                            '#10B981',
                            '#F59E0B',
                            '#8B5CF6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Switch between pages
        function switchPage(pageId) {
            pages.forEach(page => {
                page.classList.remove('active');
                if (page.id === pageId) {
                    page.classList.add('active');
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Render pantry items
        function renderPantryItems(filter = '') {
            pantryGrid.innerHTML = '';
            
            let filteredItems = appState.pantryItems;
            if (filter === 'expiring') {
                filteredItems = filteredItems.filter(item => item.status === 'expiring');
            } else if (filter) {
                filteredItems = filteredItems.filter(item => item.category.toLowerCase() === filter);
            }
            
            filteredItems.forEach(item => {
                const expiryDate = new Date(item.expiry);
                const today = new Date();
                const daysUntilExpiry = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
                
                const card = document.createElement('div');
                card.className = 'pantry-item-card';
                card.innerHTML = `
                    <div class="expiry-badge ${item.status === 'expiring' ? 'expiry-soon' : 'expiry-good'}">
                        ${item.status === 'expiring' ? 'Expiring Soon' : 'Fresh'}
                    </div>
                    <div class="item-header">
                        <div class="item-icon" style="background: ${getCategoryColor(item.category)};">
                            ${getCategoryIcon(item.category)}
                        </div>
                        <div>
                            <div class="item-name">${item.name}</div>
                            <div style="color: var(--gray); font-size: 14px;">${item.location}</div>
                        </div>
                    </div>
                    <div class="item-meta">
                        <div>
                            <div style="font-weight: 600;">Quantity</div>
                            <div>${item.quantity}</div>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Expires</div>
                            <div>${formatDate(item.expiry)} (${daysUntilExpiry} days)</div>
                        </div>
                    </div>
                    <div style="margin: 16px 0;">
                        <div style="font-weight: 600; margin-bottom: 8px;">Usage Suggestion:</div>
                        <div style="color: var(--gray); font-size: 14px;">${getUsageSuggestion(item)}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-sm btn-primary" onclick="useItem(${item.id})">
                            <i class="fas fa-check"></i> Use
                        </button>
                        <button class="btn btn-sm btn-secondary" onclick="editItem(${item.id})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="removeItem(${item.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                pantryGrid.appendChild(card);
            });
            
            updateDashboardStats();
        }

        // Filter pantry items
        function filterPantryItems(category) {
            renderPantryItems(category);
        }

        // Add pantry item
        function addPantryItem() {
            const name = document.getElementById('itemName').value;
            const quantity = document.getElementById('itemQuantity').value;
            const category = document.getElementById('itemCategory').value;
            const expiry = document.getElementById('itemExpiry').value;
            const location = document.getElementById('itemLocation').value;
            const notes = document.getElementById('itemNotes').value;
            
            if (!name || !quantity) {
                showToast("Please fill in all required fields", "error");
                return;
            }
            
            const newItem = {
                id: appState.pantryItems.length + 1,
                name,
                quantity,
                category,
                expiry: expiry || new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                location,
                notes,
                status: new Date(expiry) - new Date() < 3 * 24 * 60 * 60 * 1000 ? 'expiring' : 'good'
            };
            
            appState.pantryItems.push(newItem);
            renderPantryItems();
            closeModal('addItemModal');
            showToast(`${name} added to pantry`, "success");
            
            // Clear form
            document.getElementById('itemName').value = '';
            document.getElementById('itemQuantity').value = '';
            document.getElementById('itemExpiry').value = '';
            document.getElementById('itemNotes').value = '';
        }

        // Use item
        function useItem(itemId) {
            const item = appState.pantryItems.find(i => i.id === itemId);
            if (item) {
                appState.pantryItems = appState.pantryItems.filter(i => i.id !== itemId);
                renderPantryItems();
                showToast(`Used ${item.name}`, "success");
                addChatMessage(`user`, `I just used ${item.name} from my pantry.`);
                addChatMessage(`ai`, `Great! I'll update your pantry and meal suggestions accordingly. Would you like me to suggest a replacement for your shopping list?`);
            }
        }

        // Edit item
        function editItem(itemId) {
            const item = appState.pantryItems.find(i => i.id === itemId);
            if (item) {
                document.getElementById('itemName').value = item.name;
                document.getElementById('itemQuantity').value = item.quantity;
                document.getElementById('itemCategory').value = item.category;
                document.getElementById('itemExpiry').value = item.expiry;
                document.getElementById('itemLocation').value = item.location;
                document.getElementById('itemNotes').value = item.notes;
                showModal('addItemModal');
            }
        }

        // Remove item
        function removeItem(itemId) {
            const item = appState.pantryItems.find(i => i.id === itemId);
            if (item && confirm(`Are you sure you want to remove ${item.name}?`)) {
                appState.pantryItems = appState.pantryItems.filter(i => i.id !== itemId);
                renderPantryItems();
                showToast(`${item.name} removed from pantry`, "success");
            }
        }

        // Render weekly calendar
        function renderWeeklyCalendar() {
            weeklyCalendar.innerHTML = '';
            
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            days.forEach(day => {
                const meal = appState.mealPlan.find(m => m.day === day);
                const dayElement = document.createElement('div');
                dayElement.className = 'pantry-item-card';
                dayElement.innerHTML = `
                    <div style="font-weight: 700; margin-bottom: 12px; color: var(--primary);">${day}</div>
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 12px; color: var(--gray);">Breakfast</div>
                        <div>${meal.breakfast}</div>
                    </div>
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 12px; color: var(--gray);">Lunch</div>
                        <div>${meal.lunch}</div>
                    </div>
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 12px; color: var(--gray);">Dinner</div>
                        <div>${meal.dinner}</div>
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--gray);">Snacks</div>
                        <div>${meal.snacks.join(', ')}</div>
                    </div>
                    <button class="btn btn-sm btn-primary" style="margin-top: 12px; width: 100%;" onclick="regenerateMeal('${day}')">
                        <i class="fas fa-redo"></i> Regenerate
                    </button>
                `;
                weeklyCalendar.appendChild(dayElement);
            });
        }

        // Regenerate meal for a day
        function regenerateMeal(day) {
            showToast(`Generating new meal suggestions for ${day}...`, "info");
            setTimeout(() => {
                showToast(`${day}'s meals regenerated with AI`, "success");
            }, 1000);
        }

        // Render recipe suggestions
        function renderRecipeSuggestions() {
            recipeSuggestions.innerHTML = '';
            
            const recipes = [
                { name: "Chicken & Broccoli Stir Fry", prepTime: "25 min", difficulty: "Easy", rating: 4.8, tags: ["High Protein", "Low Carb"] },
                { name: "Vegetable Curry", prepTime: "35 min", difficulty: "Medium", rating: 4.5, tags: ["Vegetarian", "Spicy"] },
                { name: "Quinoa Salad Bowl", prepTime: "20 min", difficulty: "Easy", rating: 4.9, tags: ["Vegan", "Gluten Free"] },
                { name: "Salmon with Roasted Veggies", prepTime: "30 min", difficulty: "Medium", rating: 4.7, tags: ["Omega-3", "High Protein"] }
            ];
            
            recipes.forEach(recipe => {
                const recipeElement = document.createElement('div');
                recipeElement.className = 'pantry-item-card';
                recipeElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div style="font-weight: 700; font-size: 18px;">${recipe.name}</div>
                        <div style="background: var(--accent); color: white; padding: 4px 8px; border-radius: 6px; font-size: 12px;">
                            ${recipe.rating} <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <div style="display: flex; gap: 12px; margin-bottom: 12px; color: var(--gray); font-size: 14px;">
                        <div><i class="fas fa-clock"></i> ${recipe.prepTime}</div>
                        <div><i class="fas fa-signal"></i> ${recipe.difficulty}</div>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 16px;">
                        ${recipe.tags.map(tag => `<span style="background: #F1F5F9; padding: 4px 8px; border-radius: 12px; font-size: 12px;">${tag}</span>`).join('')}
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-sm btn-primary" onclick="viewRecipe('${recipe.name}')">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn btn-sm btn-secondary" onclick="addToMealPlan('${recipe.name}')">
                            <i class="fas fa-plus"></i> Add to Plan
                        </button>
                    </div>
                `;
                recipeSuggestions.appendChild(recipeElement);
            });
        }

        // Render shopping list
        function renderShoppingList() {
            shoppingListContainer.innerHTML = '';
            
            let total = 0;
            appState.shoppingList.forEach(item => {
                total += item.estimatedPrice;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'shopping-item';
                itemElement.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                        <div style="width: 20px; height: 20px; border: 2px solid var(--border); border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center;"
                             onclick="toggleShoppingItem(${item.id})">
                            ${item.checked ? '<i class="fas fa-check" style="color: var(--secondary);"></i>' : ''}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; ${item.checked ? 'text-decoration: line-through; color: var(--gray);' : ''}">
                                ${item.name}
                            </div>
                            <div style="font-size: 14px; color: var(--gray);">
                                ${item.quantity}  ${item.category}  $${item.estimatedPrice.toFixed(2)}
                            </div>
                        </div>
                        <div style="font-size: 12px; background: #F1F5F9; padding: 4px 8px; border-radius: 12px;">
                            ${item.store}
                        </div>
                    </div>
                    <button class="btn btn-sm btn-danger" onclick="removeShoppingItem(${item.id})">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                shoppingListContainer.appendChild(itemElement);
            });
            
            document.getElementById('shoppingTotal').textContent = `$${total.toFixed(2)}`;
        }

        // Toggle shopping item
        function toggleShoppingItem(itemId) {
            const item = appState.shoppingList.find(i => i.id === itemId);
            if (item) {
                item.checked = !item.checked;
                renderShoppingList();
            }
        }

        // Remove shopping item
        function removeShoppingItem(itemId) {
            appState.shoppingList = appState.shoppingList.filter(i => i.id !== itemId);
            renderShoppingList();
        }

        // Render AI recommendations
        function renderAIRecommendations() {
            aiRecommendationsContainer.innerHTML = '';
            
            const recommendations = [
                { 
                    title: "Reduce Food Waste", 
                    description: "Based on your expiring items, make broccoli soup tonight. You have all ingredients!",
                    icon: "fa-recycle",
                    action: "View Recipe",
                    color: "#10B981"
                },
                { 
                    title: "Budget Saver", 
                    description: "Switch bell peppers from Whole Foods to Trader Joe's to save $1.50 per pound.",
                    icon: "fa-wallet",
                    action: "Update List",
                    color: "#F59E0B"
                },
                { 
                    title: "Nutrition Boost", 
                    description: "Add more leafy greens to your meal plan for better iron absorption.",
                    icon: "fa-heartbeat",
                    action: "Add Suggestions",
                    color: "#EF4444"
                }
            ];
            
            recommendations.forEach(rec => {
                const recElement = document.createElement('div');
                recElement.className = 'pantry-item-card';
                recElement.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div style="width: 40px; height: 40px; border-radius: 10px; background: ${rec.color}20; display: flex; align-items: center; justify-content: center;">
                            <i class="fas ${rec.icon}" style="color: ${rec.color};"></i>
                        </div>
                        <div style="font-weight: 700;">${rec.title}</div>
                    </div>
                    <div style="color: var(--gray); margin-bottom: 16px;">${rec.description}</div>
                    <button class="btn btn-sm btn-primary" style="width: 100%;">
                        <i class="fas fa-bolt"></i> ${rec.action}
                    </button>
                `;
                aiRecommendationsContainer.appendChild(recElement);
            });
        }

        // Generate AI meal suggestions
        function generateAISuggestions() {
            showToast("AI is analyzing your pantry and preferences...", "info");
            
            // Simulate API call to LLM wrapper
            setTimeout(() => {
                showToast("Generated 5 personalized meal suggestions using GPT-4", "success");
                
                // In real implementation, this would call:
                // fetch(appState.llmWrapperUrl, {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({
                //         prompt: "Generate meal suggestions based on user pantry",
                //         pantryItems: appState.pantryItems,
                //         preferences: {...}
                //     })
                // })
                
                addChatMessage("ai", "I've analyzed your pantry and generated 5 meal suggestions! Here are my top picks:\n\n1. Chicken & Broccoli Stir Fry (uses expiring broccoli)\n2. Veggie Pasta (uses pasta & tomato sauce)\n3. Egg Fried Rice (uses rice, eggs, veggies)\n4. Smoothie Bowl (uses bananas & spinach)\n5. Garlic Roasted Veggies\n\nWhich one would you like to add to your meal plan?");
            }, 2000);
        }

        // Generate shopping list
        function generateShoppingList() {
            showToast("AI is optimizing your shopping list...", "info");
            setTimeout(() => {
                showToast("Shopping list optimized! Saved estimated $15.20 across stores", "success");
            }, 1500);
        }

        // Optimize shopping list
        function optimizeShoppingList() {
            showToast("Comparing prices across 5 stores...", "info");
            setTimeout(() => {
                showToast("Found better prices! Updated shopping list", "success");
            }, 1500);
        }

        // Compare prices
        function comparePrices() {
            showToast("Fetching real-time prices from Instacart, Amazon Fresh, and local stores...", "info");
            setTimeout(() => {
                showToast("Price comparison complete. View the store comparison section", "success");
            }, 2000);
        }

        // Export shopping list
        function exportShoppingList() {
            showToast("Exporting shopping list to Instacart...", "info");
            setTimeout(() => {
                showToast("Shopping list exported to Instacart cart", "success");
            }, 1000);
        }

        // Generate weekly plan
        function generateWeeklyPlan() {
            showToast("AI is creating your personalized weekly meal plan...", "info");
            setTimeout(() => {
                showToast("Weekly meal plan generated! Check your calendar", "success");
                renderWeeklyCalendar();
            }, 2500);
        }

        // Refresh recommendations
        function refreshRecommendations() {
            showToast("Updating AI recommendations...", "info");
            setTimeout(() => {
                showToast("Recommendations refreshed with latest data", "success");
                renderAIRecommendations();
            }, 1000);
        }

        // Scan receipt
        function scanReceipt() {
            showToast("AI scanning receipt... Extracting items and prices", "info");
            setTimeout(() => {
                showToast("Receipt scanned! 12 items added to pantry with expiry estimates", "success");
            }, 3000);
        }

        // Voice input
        function voiceInput() {
            showToast("Listening... Say 'add milk' or 'plan dinner'", "info");
            setTimeout(() => {
                showToast("Added '2 gallons of milk' to pantry via voice command", "success");
            }, 2000);
        }

        // Scan barcode
        function scanBarcode() {
            showToast("Open camera for barcode scanning...", "info");
            // In real app, this would open device camera
        }

        // Use camera
        function useCamera() {
            showToast("Open camera for item recognition...", "info");
            // In real app, this would open device camera
        }

        // Send chat message
        function sendChatMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            addChatMessage("user", message);
            chatInput.value = "";
            
            // Simulate AI response
            setTimeout(() => {
                const responses = [
                    "Based on your pantry, I suggest making a stir fry tonight with chicken and broccoli. Would you like the recipe?",
                    "I notice you have several items expiring soon. Let me create a meal plan to use them efficiently.",
                    "Your nutrition balance looks good this week! Want to optimize for more protein?",
                    "I can generate a shopping list based on your meal plan. Should I include price comparisons?"
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage("ai", randomResponse);
            }, 1000);
        }

        // Add chat message
        function addChatMessage(sender, message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${sender}`;
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show toast notification
        function showToast(message, type = "info") {
            const toastContainer = document.querySelector('.toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}" 
                   style="color: ${type === 'success' ? 'var(--secondary)' : type === 'error' ? 'var(--danger)' : 'var(--primary)'};"></i>
                <div>${message}</div>
            `;
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        // Update dashboard stats
        function updateDashboardStats() {
            document.getElementById('pantryCount').textContent = appState.pantryItems.length;
            document.getElementById('expiryCount').textContent = appState.pantryItems.filter(item => item.status === 'expiring').length;
            
            const totalMeals = appState.mealPlan.reduce((total, day) => {
                return total + (day.breakfast ? 1 : 0) + (day.lunch ? 1 : 0) + (day.dinner ? 1 : 0);
            }, 0);
            document.getElementById('mealCount').textContent = totalMeals;
            
            const shoppingItems = appState.shoppingList.filter(item => !item.checked).length;
            document.getElementById('shoppingCount').textContent = shoppingItems;
        }

        // Helper functions
        function getCategoryColor(category) {
            const colors = {
                'Protein': '#EF4444',
                'Vegetables': '#10B981',
                'Fruits': '#F59E0B',
                'Dairy': '#3B82F6',
                'Grains': '#8B5CF6',
                'Condiments': '#EC4899',
                'Beverages': '#06B6D4',
                'Spices': '#F97316'
            };
            return colors[category] || '#6B7280';
        }

        function getCategoryIcon(category) {
            const icons = {
                'Protein': 'fa-drumstick-bite',
                'Vegetables': 'fa-carrot',
                'Fruits': 'fa-apple-alt',
                'Dairy': 'fa-cheese',
                'Grains': 'fa-bread-slice',
                'Condiments': 'fa-wine-bottle',
                'Beverages': 'fa-wine-glass-alt',
                'Spices': 'fa-mortar-pestle'
            };
            const icon = icons[category] || 'fa-box';
            return `<i class="fas ${icon}"></i>`;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function getUsageSuggestion(item) {
            const suggestions = {
                'Protein': 'Great for stir fry, grilling, or adding to salads',
                'Vegetables': 'Perfect for roasting, stir fry, or fresh salads',
                'Fruits': 'Eat fresh, add to smoothies, or make desserts',
                'Dairy': 'Use in baking, cooking, or as snacks',
                'Grains': 'Cook as side dish or base for bowls'
            };
            return suggestions[item.category] || 'Use in various recipes';
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
